var ZRouter=function(t,r){var u={routes:[],root:"/",el:"#z-router-view",loaderTpl:"<p>Loading...</p>",prefix:"#",getTemplate:function(e){if(e.template)p.render(u.tp(e.template,e.options)),"function"==typeof e.callback&&e.callback(e.options);else if(e.templateUrl){p.render(u.loaderTpl);var t=new XMLHttpRequest;t.onreadystatechange=function(){4==t.readyState&&200==t.status?(e.template=t.responseText,p.render(u.tp(t.responseText,e.options)),"function"==typeof e.callback&&e.callback(e.options)):404==t.status&&p.render("<h1>Error "+t.status+"</h1>")},t.open("GET",e.templateUrl,!0),t.send()}},getFragment:function(){""===r.location.hash&&(r.location.hash=u.prefix+u.root);var e=new RegExp(u.prefix+"(.*)$"),t=r.location.href.match(e);return(t?t[1]:"").toString()},tp:function(e,t){for(var r,a=/<%([^%>]+)?%>/g,n=/(^( )?(if|for|else|switch|case|break|{|}))(.*)?/g,o="var r=[];\n",l=0,i=function(e,t){return o+=t?e.match(n)?e+"\n":"r.push("+e+");\n":""!==e?'r.push("'+e.replace(/"/g,'\\"')+'");\n':"",i};r=a.exec(e);)i(e.slice(l,r.index))(r[1],!0),l=r.index+r[0].length;return i(e.substr(l,e.length-l)),o+='return r.join("");',new Function(o.replace(/[\r\t\n]/g,"")).apply(t)}},p={setRoot:function(e){return u.root=e,p},setLoaderTpl:function(e){return u.loaderTpl=e,p},add:function(e){return"object"==typeof e&&e.url&&(e.template||e.templateUrl)?u.routes.push(e):console.log("This route has a problem, it cant be added!",e),p},check:function(e){for(var t,r,a=e||u.getFragment(),n={},o=0;o<u.routes.length;o++){var l=u.routes[o],i=new RegExp("^"+l.url.replace(/(:\w+)/g,"([\\w-]+)")+"$");if(t=a.match(i)){if(t.shift(),r=l.url.match(/(:\w+)/g))for(var s=0;s<r.length;s++)n[r[s].slice(1)]=t[s];return l.options||(l.options={}),l.options.params=n,u.getTemplate(l),p}}return p.navigate(u.root),p},listen:function(){var e,t=null;return clearInterval(e),e=setInterval(function(){t!==u.getFragment()&&(t=u.getFragment(),p.check(t))},50),p},render:function(e){return t.querySelector(u.el).innerHTML=e,p},navigate:function(e){return e=e||"",r.location.href=r.location.href.replace(/#(.*)$/,u.prefix+e),p},hashbang:function(e){return u.prefix=!0===e?"#!":"#",p}};return p}(document,window);function displayhashRoute(){var e=window.location.hash;document.querySelector(".address-bar").innerHTML=e}ZRouter.setRoot("/").setLoaderTpl("<h2>The template is loading, be patient please!</h2>").add({url:"/",template:'<h2>The root Url</h2><hr><p><span class="inline-code"> url : "<% this.url %>" </span></p><p>What is the root url?</p><ul><li>It will be automatically loaded if no route has been provided on page load</li><li>It will be loaded if no route matches the entered url</li></ul><p>It can be changed : <span class="inline-code">ZRouter.setRoot("/newRootRoute")</span></p>',options:{url:"/"},callback:function(e){displayhashRoute()}}).add({url:"/user",template:'<h2>A Normal route</h2><hr><p><span class="inline-code"> url : "<% this.url %>" </span></p><p>You could probably use this route to display a list of users...</p>',options:{url:"/user"},callback:function(e){displayhashRoute()}}).add({url:"/user/:id",template:'<h2>A route with parameter </h2><hr><p><span class="inline-code"> url : "<% this.url %>" </span></p><p><span class="inline-code"> params : id = <% this.params.id %> </span></p><p>You could probably use this route to display a specific user</p>',options:{url:"/user/:id"},callback:function(e){displayhashRoute()}}).add({url:"/fetched",templateUrl:"partials/fetched.html",options:{url:"/fetched"},callback:function(e){displayhashRoute()}}).listen(),document.querySelector("#hashbang").addEventListener("change",function(){var t=this.checked;[].forEach.call(document.querySelectorAll(".link-for-router"),function(e){e.href=t?e.href.replace("#","#!"):e.href.replace("#!","#")}),ZRouter.hashbang(t).navigate("/"),displayhashRoute()});